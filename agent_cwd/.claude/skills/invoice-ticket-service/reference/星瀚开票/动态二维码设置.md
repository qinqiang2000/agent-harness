文档适用范围：星空旗舰版开票

## 操作手册更新版本记录
| 文档版本 | 文档更新日期 | 对应产品版本号/功能更新日期 | 说明 | 更新人 |
| --- | --- | --- | --- | --- |
| V1.0 | 2025.11.05 |  | 初稿发布 |  |


## 动态二维码设置操作路径及所属模块编码
操作路径：【发票服务】→【基础资料】→【开票参数设置】→【扫码开票设置】→【动态二维码设置】

所属模块编码：F17025

所属模块名称：开票参数设置

## 动态二维码设置功能设计理念概述
### 功能概述
<font style="color:rgba(0, 0, 0, 0.85);">用于配置动态二维码的相关参数，以实现扫码开票的功能</font>

### <font style="color:rgba(0, 0, 0, 0.85);">目标客户以及客户解决核心痛点问题</font>
1. <font style="color:rgba(0, 0, 0, 0.85);">客户的外部消费者/外部客户：在需要扫码开票的场景中进行消费的消费者，解决了传统开票方式中流程繁琐、等待时间长的痛点，通过扫描动态二维码可以快速提交抬头信息或直接开具发票，提升了开票体验。</font>
2. <font style="color:rgba(0, 0, 0, 0.85);">客户的内部操作使用人员：财务或相关开票岗位，解决了手动设置动态二维码的繁琐工作，提高了工作效率，同时能够根据业务需求灵活配置二维码的相关信息。</font>
3. <font style="color:rgba(0, 0, 0, 0.85);">客户部门管理人员：财务部门管理人员，解决了对动态二维码设置进行管理和监控的痛点，能够确保二维码的设置符合业务规定和税务要求，保证开票流程的顺利进行。</font>
4. <font style="color:rgba(0, 0, 0, 0.85);">客户公司管理层：公司高层管理岗位，解决了对公司开票参数配置进行整体把握和决策的痛点，能够通过动态二维码设置的优化，提升客户体验，提高运营效率，为公司的发展提供支持。</font>

## 动态二维码设置功能详解
### 动态二维码设置关键字段说明
| **序号*** | **<font style="color:rgb(26, 26, 26);">字段名称*</font>** | **<font style="color:rgb(26, 26, 26);">业务含义*</font>** | **<font style="color:rgb(26, 26, 26);">赋值规则*</font>** | **<font style="color:rgb(26, 26, 26);">控制规则*</font>** | **<font style="color:rgb(26, 26, 26);">其他属性说明</font>** |
| --- | --- | --- | --- | --- | --- |
| 1 | 默认开票 | 设置后，系统将根据当前填写信息生成默认的预置销售单 | 创建者设定 | “是”与“否” |  |
| 2 | 业务编码 | 通过此编码搜索业务系统，并该扫码开票接入此业务的接口 | 来源于苍穹平台基础服务云--企业建模下创建的业务组织机构信息 | 必填 | 通过接口连接业务，在该业务场景中扫码开票 |
| 3 | 扫码类型 | 生成二维码后，能直接向客户开具发票，抑或是扫码只能提交抬头信息 | 创建者设定 | “扫码提交抬头”、“扫码开票” |  |
| 4 | 发票种类 | 1、数电票（增值税专用发票）：以数字化形式呈现的具有增值税专用发票功能和法律效力的发票。<br/>2、数电票（普通发票）：数字化形式的具有普通发票功能和法律效力的发票。<br/>3、纸质专用发票：以纸质形式存在的具有增值税专用发票性质的发票。<br/>4、纸质普通发票：纸质形态的具有普通发票属性和用途的发票。<br/>5、电子普通发票：以电子数据形式存在的普通发票。<br/>6、电子专用发票：电子数据形态的具有增值税专用发票效力的发票。<br/>7、增值税普通发票（卷票）：呈卷状的增值税普通发票。 |  |  |  |
| 5 | key值 | 与业务系统组装二维码的编号信息 | 系统赋值 |  |  |


### 动态二维码设置按钮说明
| **序号*** | **<font style="color:rgb(26, 26, 26);">按钮名称*</font>** | **<font style="color:rgb(26, 26, 26);">功能描述*</font>** | **<font style="color:rgb(26, 26, 26);">使用条件</font>** | **<font style="color:rgb(26, 26, 26);">其他说明</font>** |
| --- | --- | --- | --- | --- |
| 1 | 同步至移动云 | 将PC端的动态二维码设置与移动端同步 |  | 在【发票服务】-【系统管理】-【云应用参数配置】下，操作移动云初始化 |


### 动态二维码设置主要操作说明
##### 移动云初始化
**步骤一：**在【发票服务】-【系统管理】-【云应用参数配置】下，操作移动云初始化。

![](https://cdn.nlark.com/yuque/0/2025/png/56650036/1748596364974-b9f46a26-7270-4822-b38e-f296dcd8f078.png)

**步骤二：**应用系统接入配置。如果采用对接预置销售单接口的方式进行扫码开票，则需要在【发票服务】-【系统管理】-【业务系统】下配置应用系统接入信息，并启用。

![](https://cdn.nlark.com/yuque/0/2025/png/56650036/1748596382392-d3f8c5a2-452e-43ba-960c-e8f328d442fa.png)

##### 新增
**步骤一：**点击“新增”，并在新出现的一行中完善信息，例如二维码有效期，二维码有效期的单位为“天”

![](https://cdn.nlark.com/yuque/0/2025/png/56650036/1748596456255-7292c30b-6f70-4bcf-864e-ea6a95b23d86.png)

**步骤二：**信息填写完成后，点击“保存”

![](https://cdn.nlark.com/yuque/0/2025/png/56650036/1748596479633-6170a9fd-1022-4da4-b874-a4941bfc2a7f.png)

##### <font style="color:rgb(52, 64, 84);">扫码开票对接</font>
扫码开票有以下两种对接方式：推单生成二维码链接、业务系统生成二维码链接。

**<font style="color:rgb(52, 64, 84);">（1）推单生成二维码链接：</font>**[https://open.piaozone.com/api-146003738](https://open.piaozone.com/api-146003738)

**<font style="color:rgb(52, 64, 84);">使用场景</font>**<font style="color:rgb(52, 64, 84);">：商户订单系统需对接，发起开票时需要将订单信息推到发票服务生成二维码。</font>

**<font style="color:rgb(52, 64, 84);">用户可开票种规则：</font>**

<font style="color:rgb(52, 64, 84);">①商家可在星空内【动态二维码设置】处设定可开票种范围。</font>

<font style="color:rgb(52, 64, 84);">②接口invoiceType发票种类字段传值应在第①步所配票种范围内，传递范围外票种，会导致推单失败。</font>

<font style="color:rgb(52, 64, 84);">③最终用户在扫码提交抬头页面，仅可选择接口invoiceType传递票种，不支持切换票种。</font>

<font style="color:rgb(52, 64, 84);">V7.0.17更新：</font><font style="color:rgb(52, 64, 84);">此方式对接，使用</font>3.2.01上传销售单获取二维码链接<font style="color:rgb(52, 64, 84);">接口时，可通过传参”</font>scanh5Url<font style="color:rgb(52, 64, 84);">“</font><font style="color:rgb(52, 64, 84);">使用H5页面开票。</font>

<font style="color:rgb(52, 64, 84);">V7.0.18 更新：① 扫码开票，检验订单税号和key值税号是否一致，</font><font style="color:#DF2A3F;background-color:rgb(255,255,255);">不一致时进行提示：二维码key值对应税号和订单税号不一致，请联系商家提供新的二维码</font><font style="color:rgb(0,0,0);background-color:rgb(255,255,255);">，</font><font style="color:rgb(52, 64, 84);">若要开票，订单税号和key值税号不一致时以订单税号为准进行开票。②扫码开票，即使设置购方抬头映射，以用户维护的购方信息为准进行开票。</font>

![](https://cdn.nlark.com/yuque/0/2024/png/38481329/1729494676435-ca73611e-45a3-4dcf-863a-53d211a9efa0.png)<font style="color:rgb(52, 64, 84);">  
</font>![](https://cdn.nlark.com/yuque/0/2024/jpeg/38481329/1723533735553-258b08e4-107b-4822-9626-ef24796f2469.jpeg)

**<font style="color:rgb(52, 64, 84);">（2）业务系统生成二维码链接：</font>**[https://open.piaozone.com/api-146003736](https://open.piaozone.com/api-146003736)

**<font style="color:rgb(52, 64, 84);">使用场景：</font>**<font style="color:rgb(52, 64, 84);">服务商需要提供的查询订单接口地址给发票服务，并且按照成功响应示例报文返回。</font>

**对接步骤：**

<font style="color:rgb(52, 64, 84);">①服务商通过【业务系统组装二维码链接格式】接口生成二维码给到用户。</font>

②<font style="color:rgb(52, 64, 84);">用户扫码到开票界面，填写购方信息，提交开票。</font>

③<font style="color:rgb(52, 64, 84);">发票服务系统通过“查询订单接口”查询单据编号对应的明细数据。</font>

④<font style="color:rgb(52, 64, 84);">完成开票。</font>

**<font style="color:rgb(52, 64, 84);">用户可开票种规则：</font>**

<font style="color:rgb(52, 64, 84);">①商家可在星空内【动态二维码设置】处设定可开票种范围。</font>

<font style="color:rgb(52, 64, 84);">②最终用户在扫码提交抬头页面，可选择第①步中已设置的票种。</font>

![](https://cdn.nlark.com/yuque/0/2024/png/38481329/1729494683144-cd529a1e-dcd5-40d9-8648-91a1d18e09ee.png)<font style="color:rgb(52, 64, 84);">  
</font>![](https://cdn.nlark.com/yuque/0/2024/jpeg/38481329/1723533735659-d519512b-edf4-4265-a182-aba44e68c9e4.jpeg)

## 动态二维码设置相关配置说明【暂无配置】
## 动态二维码设置相关接口说明
见本文3.3节第3点。

