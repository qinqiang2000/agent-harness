## 操作手册更新版本记录
| 文档版本 | 文档更新日期 | 对应产品版本号/功能更新日期 | 说明 | 更新人 |
| --- | --- | --- | --- | --- |
| V1.0 | 2025.11.17 |  | 初稿发布 |  |
|  |  |  |  |  |


## 发票申请操作路径
【发票云】-【开票管理】-【海外发票】-【销项发票】-【发票申请】

## 发票申请功能设计理念概述
### 功能定位
发票申请用于集中展示和管理来自上游系统推送的开票请求单，对其进行状态跟踪、编辑补充、校验及提交开票操作。

### 设计理念与使用价值
+ **统一管理开票请求单**：将各业务系统通过接口推送的开票请求单集中展示，支持按状态、时间等维度统一查看和跟踪。
+ **全流程状态监控**：通过草稿、待处理、已验证、发票开具中、完全开票、开票失败等状态卡片及列表状态列，帮助用户快速把握整体处理进度。
+ **支持多国家/地区发票场景**：列表中展示“国家/地区”“发票类型”等信息，便于根据不同国家/地区的开票规则进行后续处理。
+ **校验与报错透明化**：通过“验证失败”状态及“校验报告”，帮助用户定位业务数据问题，降低报文被税局/平台拒收的风险。

## 发票申请功能详解
### 发票申请关键字段说明
| **字段名称** | **业务含义** | **字段规则说明** | **其他说明** |
| --- | --- | --- | --- |
| <font style="color:#000000;">草稿</font> | <font style="color:#000000;">处于“草稿（Draft）”状态的开票请求单。适合用于统计尚未进入校验流程、仍处于初始录入阶段的请求单数量。</font> |  | <font style="color:#000000;"></font> |
| <font style="color:#000000;">信息补全中</font> | <font style="color:#000000;">处于“补全中（Enriching）”状态的请求单数量。用于需要补数据、改数据的场景。</font> | <font style="color:#000000;"></font> | <font style="color:#000000;"></font> |
| <font style="color:#000000;">验证失败</font> | <font style="color:#000000;">处于“校验异常（Validation Failed）”状态的请求单数量。主要用于提示存在数据问题的请求单，是日常排错和数据治理的重点。</font> | <font style="color:#000000;"></font> | <font style="color:#000000;"></font> |
| <font style="color:#000000;">待处理</font> | <font style="color:#000000;">已通过系统校验、等待开票的请求单。该状态下的请求单通常已满足开票条件，可提交开票。可以进行下一步处理，例如提交开票。</font> | <font style="color:#000000;"></font> | <font style="color:#000000;"></font> |
| <font style="color:#000000;">发票开具中</font> | <font style="color:#000000;">处于“开票中（Invoicing）”状态的请求单数量。表示系统已发起开票请求，结果尚未返回。</font> | <font style="color:#000000;"></font> | <font style="color:#000000;"></font> |
| <font style="color:#000000;">部分开票</font> | <font style="color:#000000;">同一请求单下部分发票已成功开具、其余仍未完成的数量。</font> | <font style="color:#000000;"></font> | <font style="color:#000000;"></font> |
| <font style="color:#000000;">完全开票</font> | <font style="color:#000000;">处于“开票成功（Invoiced Success）”状态的请求单数量。表示该请求单关联的发票已全部开具成功。</font> | <font style="color:#000000;"></font> | <font style="color:#000000;"></font> |
| <font style="color:#000000;">已作废</font> | <font style="color:#000000;">处于“作废（Void）”状态的请求单数量。</font><font style="color:rgba(0, 0, 0, 0.88);">作废后该申请单将无法再开票。</font> | <font style="color:#000000;"></font> | <font style="color:#000000;"></font> |
| <font style="color:#000000;">开票失败</font> | <font style="color:#000000;">处于“开票失败（Invoiced Failure）”状态的请求单数量。该状态下需结合错误信息和“校验报告”进行排查，可选择修正后重试或直接作废。</font> |  |  |
| <font style="color:#000000;">时间范围</font> | <font style="color:#000000;">用于限定查询的时间范围。</font> | <font style="color:#000000;">按创建时间进行过滤。</font> | <font style="color:#000000;"></font> |
| <font style="color:#000000;">请求单号</font> | <font style="color:#000000;">系统中开票请求单的唯一编号。</font> | <font style="color:#000000;">列表中以超链接形式展示，如“HXB-00003257”。点击后进入开票请求单详情页。</font> | <font style="color:#000000;"></font> |
| <font style="color:#000000;">公司名称</font> | <font style="color:#000000;">开票请求单中的购方公司名称。</font> | <font style="color:#000000;"></font> | <font style="color:#000000;"></font> |
| <font style="color:#000000;">国家/地区</font> | <font style="color:#000000;">请求单对应的国家/地区代码。</font> | <font style="color:#000000;">如“NL”代表 Netherlands。</font> | <font style="color:#000000;"></font> |
| <font style="color:#000000;">金额</font> | <font style="color:#000000;">开票请求单的总金额。</font> | <font style="color:#000000;"></font> | <font style="color:#000000;"></font> |
| <font style="color:#000000;">税额</font> | <font style="color:#000000;">开票请求单的总税额。</font> | <font style="color:#000000;"></font> | <font style="color:#000000;"></font> |
| <font style="color:#000000;">发票类型</font> | <font style="color:#000000;">开票请求单的发票类型。</font> | <font style="color:#000000;">示例值为“Commercial Invoice”。</font> | <font style="color:#000000;">与后续生成的实际发票类型对应。</font> |
| <font style="color:#000000;">状态</font> | <font style="color:#000000;">开票请求单当前处理状态。系统随着业务流程自动变更状态。</font> | <font style="color:#000000;">与上方状态卡片一一对应，如“草稿”“验证失败”等。</font> | <font style="color:#000000;"></font> |
| <font style="color:#000000;">创建时间</font> | <font style="color:#000000;">开票请求单在系统中的创建时间。</font> | <font style="color:#000000;">示例“2025-11-11 09:08:57”。</font> | <font style="color:#000000;"></font> |


### 发票申请按钮说明
| **按钮名称*** | **功能描述*** | **使用条件** | **其他说明** |
| --- | --- | --- | --- |
| <font style="color:#000000;">查询</font> | <font style="color:#000000;">根据当前输入的“按请求单号或ID搜索...”和“时间范围”等条件，刷新发票请求列表。</font> |  |  |
| <font style="color:#000000;">重置</font> | <font style="color:#000000;">清空当前查询条件，并恢复默认条件。</font> |  |  |
| <font style="color:#000000;">作废</font> | <font style="color:#000000;">将勾选的发票请求单作废。</font> |  |  |
| <font style="color:#000000;">下查发票</font> | <font style="color:#000000;">查看与选中请求单相关联的发票信息。</font> | <font style="color:#000000;"></font> | <font style="color:#000000;"></font> |
| <font style="color:#000000;">提交 (0)</font> | <font style="color:#000000;">批量提交勾选的发票请求单进入开票流程。按钮上的数字为当前勾选数量。</font> | <font style="color:#000000;"></font> | <font style="color:#000000;"></font> |
| <font style="color:#000000;">列设置</font> | <font style="color:#000000;">打开列表列配置，允许用户自定义显示/隐藏或排序列。</font> | <font style="color:#000000;"></font> | <font style="color:#000000;"></font> |
| <font style="color:#000000;">请求单号（蓝色链接）</font> | <font style="color:#000000;">进入对应的【编辑开票请求单】页面，对该请求单进行查看与编辑。</font> | <font style="color:#000000;"></font> | <font style="color:#000000;"></font> |
| <font style="color:#000000;">下载原始XML</font> | <font style="color:#000000;">下载上游系统/接口传入的原始开票请求XML报文。</font> |  |  |
| <font style="color:#000000;">下载XML</font> | <font style="color:#000000;">下载系统处理后的当前请求单XML报文。</font> |  |  |
| <font style="color:#000000;">预览发票</font> | <font style="color:#000000;">按当前请求单数据生成预览发票样式，进行开票前的发票预览。</font> |  |  |
| <font style="color:#000000;">刷新</font> | <font style="color:#000000;">刷新当前请求单页面数据。</font> | <font style="color:#000000;"></font> | <font style="color:#000000;"></font> |
| <font style="color:#000000;">校验报告</font> | <font style="color:#000000;">打开当前请求单的校验报告，查看校验结果及提示信息。</font> |  |  |


### 发票申请主要操作说明
#### 按条件查询开票请求单
**操作目标**：根据请求单号、时间范围等条件，快速定位需要处理的开票请求单。

**操作步骤**：

1. 在页面上方的“发票请求管理”区域，确认状态卡片统计信息。

![](https://cdn.nlark.com/yuque/0/2025/png/38481329/1763459608641-dffff3a0-47d8-4380-a4ae-f86aee6b1266.png)

2. 在“发票请求列表”上方：
    1. 在“按请求单号或ID搜索...”中输入目标请求单号或ID关键字（可为空）。
    2. 在“时间范围”右侧的下拉选择中选择时间段（如需要）。

![](https://cdn.nlark.com/yuque/0/2025/png/38481329/1763459629964-cb709feb-6bd4-4c19-bdcc-ed9eedc2189b.png)

3. 点击【查询】按钮，系统根据条件刷新列表。
4. 如需清空条件并恢复默认查询，点击【重置】，随后再次点击【查询】即可。

![](https://cdn.nlark.com/yuque/0/2025/png/38481329/1763459640715-bc214a82-72db-4d76-ae35-819e52d0d586.png)

**结果说明**：

+ 列表将展示满足条件的开票请求单记录。
+ 如无记录，列表为空，可检查时间范围或请求单号是否正确。
+ 状态列和上方的状态卡片可帮助评估整体处理量。

#### 查看并编辑开票请求单
**操作目标**：查看接口生成的开票请求单详情，并对必要字段进行补充或修改。

**操作步骤**：

1. 在“发票请求列表”中，通过查询或滚动找到目标请求单。
2. 点击该行的请求单号链接，进入【编辑开票请求单】页面。

![](https://cdn.nlark.com/yuque/0/2025/png/38481329/1763459704711-682795ca-19f2-43ed-9c78-a93bca29ea26.png)

3. 在页面顶部可看到：
+ 请求单号；
+ 当前状态标签。

![](https://cdn.nlark.com/yuque/0/2025/png/38481329/1763459728975-5603cb48-d43f-41dd-ba41-c6fd3c7ad4c3.png)

4. 在“基础信息”“交易方信息”“商品详情”等区域，根据业务需要对常见业务字段进行维护或调整。

![](https://cdn.nlark.com/yuque/0/2025/png/38481329/1763459775768-d7eeac3a-0531-433c-98b5-82ed19ecb27a.png)

5. 编辑完成后，点击【保存】按钮，系统保存修改结果。

![](https://cdn.nlark.com/yuque/0/2025/png/38481329/1763459784760-3ae4d0e5-7365-49f2-9722-3003c2061bdc.png)

**结果说明**：

+ 若后续需要提交开票，可继续执行“提交开票”操作（见下文）。

#### 提交开票请求单开票
**操作目标**：将已经确认无误的开票请求单提交至开票流程，生成正式发票。

**操作步骤（单笔提交）**：

1. 按“3.3.2”进入【编辑开票请求单】页面。
2. 确认各业务字段内容正确、完整，特别是与税务合规相关的信息。
3. 可先点击【保存】后再点击【提交开票】。

![](https://cdn.nlark.com/yuque/0/2025/png/38481329/1763459900249-1f7da8ee-6544-409b-9add-7e900393f4e0.png)

**操作步骤（批量提交）**：

1. 在“发票请求列表”中勾选若干条需要提交的请求单。
2. 点击列表上方的【提交 (0)】按钮（数字会随勾选条数变化）。

![](https://cdn.nlark.com/yuque/0/2025/png/38481329/1763459923352-ecfc8261-1a07-4bd6-9bfc-f9effdb7867d.png)

**结果说明**：

+ 提交成功后，请求单状态通常会变为“发票开具中”，待接口返回结果后更新为“完全开票”或“开票失败”等。

#### 查看验证失败原因并修正
**操作目标**：处理状态为“验证失败”的开票请求单，查看错误原因并进行修正。

**操作步骤**

1. 在“发票请求管理”页面上方的状态卡片中关注“验证失败”数量，或在列表中直接找到状态为“验证失败”的记录。

![](https://cdn.nlark.com/yuque/0/2025/png/38481329/1763460166715-2afe5534-2db8-449c-af28-58b917239172.png)

2. 点击该记录的请求单号进入【编辑开票请求单】页面。
3. 点击右上角的【校验报告】按钮，查看本单的详细校验错误信息（包括错误项、告警项、提失败字段路径等信息）。

![](https://cdn.nlark.com/yuque/0/2025/png/38481329/1763460222823-29373f2e-6553-49ee-ae78-aa5416ddea36.png)

4. 根据校验报告中的提示，在页面各信息区域修改对应业务字段。
5. 修改完成后点击【保存】，如需要重新触发开票可点击【提交开票】。

#### 作废开票请求单
**操作目标**：对不再需要开票或错误生成的开票请求单进行作废处理，避免误开票。

**操作步骤**：

1. 在“发票请求列表”中，通过查询条件或直接勾选目标请求单。
2. 勾选一条或多条需要作废的记录（左侧勾选框）。
3. 点击列表上方的【作废】按钮。

![](https://cdn.nlark.com/yuque/0/2025/png/38481329/1763460289928-475eddc5-f189-4847-aa20-ee40ee9ce792.png)

**结果说明**：

+ 作废成功后，对应请求单状态更新为“已作废”。
+ 已作废的请求单通常不能再提交开票。

#### 下查发票
**操作目标**：从开票请求单直接查看其关联的实际发票信息。

**操作步骤**：

1. 在“发票请求列表”中，勾选已完成或部分完成开票的请求单（状态如“完全开票”“部分开票”等）。
2. 点击列表上方的【下查发票】按钮。

![](https://cdn.nlark.com/yuque/0/2025/png/38481329/1763460614663-4aa25136-b769-4029-a40e-86d857935a2a.png)

3. 系统将跳转至对应的发票列表进行查看。

**结果说明**：

+ 便于从请求单向下追溯到实际发票，进行金额、税额和状态核对。

#### 查看开票请求单变更历史
**操作目标**  
查看某一开票请求单从创建到当前的状态变更及相关操作记录，支持问题追踪与审计。

**操作步骤**

1. 在【发票请求管理】页面的“发票请求列表”中，找到目标请求单。
2. 在该行“操作”列中，点击用于查看历史的图标按钮。

![](https://cdn.nlark.com/yuque/0/2025/png/38481329/1763460905435-e3de2b60-a031-4f9f-a60a-944bed1dbece.png)

3. 系统弹出【数据变更历史】窗口。如只需查看状态流转，点击顶部“生命周期(状态变更)”页签，仅查看状态相关记录。可以查看状态变更、字段变更等明细记录。

![](https://cdn.nlark.com/yuque/0/2025/png/38481329/1763460951090-bf451891-ee05-4893-890b-9241a91ffe90.png)![](https://cdn.nlark.com/yuque/0/2025/png/38481329/1763460956860-eb19984a-e3db-442e-947f-1ed92c2d010a.png)

4. 如需查看更多历史，可在弹窗底部继续向下滚动，直到提示“已加载全部记录”。

**结果说明**

+ 用户可清晰看到从“创建记录”到各次“状态变更”的时间、状态、操作人及操作方式。
+ 若发现异常状态切换（如频繁作废、状态回退等），可用于进一步排查上游系统或用户操作原因。

#### 查看发票请求验证详情
**操作目标**  
从开票请求单中进入【发票请求验证详情】页面，查看补全与验证引擎的执行日记及验证结果，用于定位数据问题及合规校验情况。

**操作步骤**

1. 在【发票请求管理】页面中，通过列表定位到目标请求单，并点击请求单号进入【编辑开票请求单】页面。
2. 在编辑页面右上角，点击【校验报告】或日志相关按钮。

![](https://cdn.nlark.com/yuque/0/2025/png/38481329/1763461240075-705f4576-048c-4c11-81aa-465f65d7f91c.png)

3. 在“发票请求验证详情”页面顶部，查看整体状态如：“提交时间”“完成时间”等概览信息。

![](https://cdn.nlark.com/yuque/0/2025/png/38481329/1763461437444-1d3d27a3-f179-4490-9816-157548ce4142.png)

4. 切换至 **“字段分解”** 标签，查看各业务分组（如“Tax Total”）下每个字段的当前值、字段标识符以及“原始字段/补全字段”来源标记。

![](https://cdn.nlark.com/yuque/0/2025/png/38481329/1763461498983-10b258a4-f86d-4970-861c-675a3150888c.png)

5. 切换至 **“引擎执行”** 标签，查看“发票补全引擎”“发票验证引擎”的执行总览及每个引擎的明细列表，确认是否全部“成功”。

![](https://cdn.nlark.com/yuque/0/2025/png/38481329/1763461511691-2cc561c5-abaf-4284-b847-8db09a4c1099.png)

6. 切换至 **“验证结果”** 标签，查看“整体验证评估”“验证通过/验证失败/风险警告”分类及“合规验证引擎执行日志”中每条规则的执行结果和合规备注。

![](https://cdn.nlark.com/yuque/0/2025/png/38481329/1763461526031-c22254f2-58f1-45d9-8b8b-1b0b1bf66322.png)

7. 如需导出供线下分析，点击右上角【导出报告】按钮。

![](https://cdn.nlark.com/yuque/0/2025/png/38481329/1763461538563-99eba180-d2c3-4231-a237-a4cd3c3c1054.png)

8. 若已在请求单上修正数据，可在该页面右上角点击【重新验证】按钮，重新执行补全与验证流程。

![](https://cdn.nlark.com/yuque/0/2025/png/38481329/1763461547706-3637f324-f75f-4573-a44a-30010468ae98.png)

**结果说明**

+ 若所有关键验证规则均显示在“验证通过”中且无“验证失败/风险警告”，通常表示该请求单在合规层面已满足要求，可继续提交开票。

